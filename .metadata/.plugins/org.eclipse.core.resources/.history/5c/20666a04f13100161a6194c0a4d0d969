package com.liuyihui.springdemo.model01;

import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;

import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
/**
 * java实现HMAC_SHA1加密
 * 
 * @author liuyihui
 *
 */
public class HMACSHA1 {
	/**
	 * 加密算法
	 */
	private static final String HMAC_SHA1 = "HmacSHA1";
	
	/**
	 * 
	 * @param src 代加密的字节数据
	 * @return 加密后的字节数据
	 * @throws NoSuchAlgorithmException
	 * @throws InvalidKeyException
	 */
	public static byte[] encrypt(byte[] src ,byte[] key) throws NoSuchAlgorithmException, InvalidKeyException{
		
		SecretKeySpec signingKey=new SecretKeySpec(src, HMAC_SHA1);
		
		Mac mac = Mac.getInstance(HMAC_SHA1);
		mac.init(signingKey);
		byte [] result = mac.doFinal(src);
		
		return result;
	}
}
